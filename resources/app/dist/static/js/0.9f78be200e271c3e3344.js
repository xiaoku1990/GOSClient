webpackJsonp([0],{"6BN9":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NERDOEM0RjQ1N0RFMTFFNzg3MEE4RTJGNTMwMTRFODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NERDOEM0RjU1N0RFMTFFNzg3MEE4RTJGNTMwMTRFODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0REM4QzRGMjU3REUxMUU3ODcwQThFMkY1MzAxNEU4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0REM4QzRGMzU3REUxMUU3ODcwQThFMkY1MzAxNEU4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnY1M3EAAAH1SURBVHja7NndSgJBFAfw4ygV+AgVXmkJBUIQRBDUK0Q3XfQMXvQSEdE7FFT0CEEQZR/2QR9Wa6K4XpgFqVGsWJtO8xeSLaIvVx1jDojs7Jxzfi7r7K66Oju7A263e8Hv7+1nzEmyRLlcIk2LRgzDmCKvtyei6zqXMeCCj/l8vj6Px0MyBlzwMYfDQTIHfIxaIBRSIRVSIf8Lcj2bI+9GqPIuHZKL12I6Q5PHZ/Tw8lJ5xzaXBVninGYSSZrWrt6NYxvj2N9UpCkAQYGZT6Y+3Y9x7DdrhLr+mvhcLtPkSYS2cvkv561e31Cm+ERLgX5qY6xxR7JQKtFo+PBb4FtgHuYjryHI7LNJA9t7FDcKv8rDfOQhv67IeKFAgdAu5f7QCIE85KNOXZDb+Xsa3tmvnIu1BPJRB/VsRa5kbmn86MTWBRr1UNcW5GxSp+CFZtvCbL0AoC7q14QMalGaS+i2A61Q1EefXyORPHF8Ssvpm7oBrb3QB/34T5FFcWKPhQ9oM5unRgb6jYq+xU++mO+Qd2KJGNoJ0+Wj0ZRbMk30Rf+7D0tcFWmKTzCyd0DX4hLWzEB/OEzLEa0ineIhvKujXYqbXDiclh8tqjcYTAyuDQ6oxweFVEiFVMhWRHLOpQbCx2Kx2HkqlZISCBd8jlb4H+dVgAEAGPGdickdqLcAAAAASUVORK5CYII="},BSoj:function(e,t,o){"use strict";var r=o("IcnI"),a={name:"line-chart",props:{dataArray:Array,xField:String|Number,yField:String|Number,xName:String,yName:String,xFormatter:String|Function,yFormatter:String|Function,valueMax:String|Number},watch:{dataArray:function(e){this.chartOption.dataset.source=e,this.updateChart()}},data:function(){var e=this;return{chart:null,chartTrue:!1,chartOption:{tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#8c7cde",formatter:function(t){var o=t.seriesData.length?"xFormatter":"yFormatter";if(void 0===e[o])return Math.floor(100*t.value)/100;var r=e[o];return"string"==typeof r?(r=r.replace("{value}",Math.floor(100*t.value)/100),r):"function"==typeof r?r(t.value,t.seriesData[0].dataIndex):void 0}}},formatter:function(t){var o=t[0].value[e.yField];if(void 0!==e.yFormatter){var r=e.yFormatter;"string"==typeof r?o=r.replace("{value}",Math.floor(100*o)/100):"function"==typeof r&&(o=r(o,t[0].dataIndex))}return t[0].marker+t[0].axisValueLabel+": "+o}},dataset:{source:this.dataArray},xAxis:{name:this.xName,type:"category",boundaryGap:!1,axisLabel:{formatter:this.xFormatter,color:"#666",fontSize:12}},yAxis:{name:this.yName,type:"value",axisLine:{lineStyle:{color:"#666"}},nameTextStyle:{color:"#666",fontSize:12},min:0,max:this.valueMax,axisLabel:{formatter:this.yFormatter,color:"#666",fontSize:12}},series:[{encode:{x:this.xField,y:this.yField},type:"line",areaStyle:{normal:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#c6b9ff"},{offset:1,color:"#e4dffd"}])}},lineStyle:{normal:{color:"transparent"}},emphasis:{itemStyle:{color:"#c6b9ff"}}}]}}},mounted:function(){this.initChart()},computed:{charResize:function(){return this.chartTrue&&this.chart.resize(),r.a.state.vuexWidth}},methods:{initChart:function(){this.chart=this.$echarts.init(this.$refs.myEchart),this.chart.setOption(this.chartOption),this.chartTrue=!0},updateChart:function(){this.chart.setOption({dataset:{source:this.dataArray}})}}},i={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"myEchart",staticClass:"line-chart",model:{value:e.charResize,callback:function(t){e.charResize=t},expression:"charResize"}})},staticRenderFns:[]};var n=o("vSla")(a,i,!1,function(e){o("ioPB")},"data-v-0f2c6c89",null);t.a=n.exports},CaOM:function(e,t,o){"use strict";function r(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}function a(e){var t=new Date;t.setTime(t.getTime()-2592e5),e.$emit("pick",t)}function i(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}function n(e){var t=new Date;t.setTime(t.getTime()-2592e6),e.$emit("pick",t)}function l(e){var t=new Date;t.setTime(t.getTime()-7776e6),e.$emit("pick",t)}function s(e){var t=new Date;t.setTime(t.getTime()-15552e6),e.$emit("pick",t)}function c(e){var t=new Date;t.setTime(t.getTime()-31536e6),e.$emit("pick",t)}t.a=function(){var e="/GOSSystem/",t=[{floor_name:"不限",floor_id:0,area_list:[]}],o=[{area_name:"不限",area_id:0}];return{url:{floorAreaList:e+"getFloorAreaList",stopDailyLog:e+"getStopDailyLog",carposRatioChart:e+"getCarposRatioChart",lightManager:e+"lightManager",lightDeviceList:e+"lightDeviceList",environmentManager:e+"environmentManager",environmentList:e+"environmentList",getErrorLog:e+"getErrorLog"},util:{floorAreaListAppendNull:function(e){var r=t.concat(e);for(var a in r){var i=o.concat(r[a].area_list);r[a].area_list=i}return r}},list:{carTypes:[{car_type_id:0,car_type_name:"不限"},{car_type_id:1,car_type_name:"正常"},{car_type_id:2,car_type_name:"超时车"},{car_type_id:3,car_type_name:"过夜车"},{car_type_id:4,car_type_name:"违停车"}],deviceTypes:[{dev_type_id:0,dev_type_name:"全部"},{dev_type_id:1,dev_type_name:"灯"},{dev_type_id:2,dev_type_name:"照片摄像头"},{dev_type_id:3,dev_type_name:"wifi"},{dev_type_id:4,dev_type_name:"蓝牙"},{dev_type_id:5,dev_type_name:"2.4G"},{dev_type_id:6,dev_type_name:"红绿灯"},{dev_type_id:7,dev_type_name:"视频摄像头"},{dev_type_id:8,dev_type_name:"引导屏"},{dev_type_id:9,dev_type_name:"扩展坞"},{dev_type_id:10,dev_type_name:"一氧化碳传感器"},{dev_type_id:11,dev_type_name:"音响"}],dates:[{text:"昨天",onClick:r},{text:"三天前",onClick:a},{text:"一周前",onClick:i},{text:"一个月前",onClick:n},{text:"三个月前",onClick:l},{text:"半年前",onClick:s},{text:"一年前",onClick:c}],sheetHeaderTitles:["停车类型","进入车位时间","驶出车位时间","停放时长","楼层","车区","车位","车牌"],sheetHeaderFields:["car_type","in_time","out_time","stop_time","floor_name","area_name","carpos_name","car_number"],carposRatioSheetHeaderTitles:["楼层","区域","入位车流","出位车流","车位数","统计时间","车位利用率"],carposRatioSheetHeaderFields:["floor_name","area_name","inCarpos","outCarpos","totalCarpos","time","value"],auth:[{id:0,label:"车辆状态图"},{id:1,label:"车位利用率"},{id:2,label:"黑白名单"},{id:3,label:"停车日志"},{id:4,label:"监控管理"},{id:5,label:"照明系统"},{id:6,label:"环境系统"},{id:7,label:"引导屏管理"},{id:8,label:"车位管理"},{id:9,label:"寻车管理"},{id:10,label:"故障日志"},{id:11,label:"系统管理",children:[{id:1e3,label:"通用设置"},{id:1001,label:"部门信息管理"},{id:1002,label:"角色管理与授权"},{id:1003,label:"人员管理与授权"},{id:1004,label:"敏感操作日志"}]}]},config:{userId:"1",pageItemSize:10,smallPageItemSize:5,tableExportName:"停车日志导出_",carposRatioTableExportName:"车位利用率导出_",tableDateFormat:"yyyy-MM-dd hh:mm:ss",tableExportDateFormat:"yyyyMMddhhmmss",tableDisplayDateFormat:"yyyy-MM-dd HH:mm",htmlDateFormat:"yyyy-MM-dd HH:mm:SS",coAverageMaxValue:200}}}},JhHb:function(e,t,o){o("SAFe");var r=o("AKd3").Object;e.exports=function(e,t,o){return r.defineProperty(e,t,o)}},SAFe:function(e,t,o){var r=o("FITv");r(r.S+r.F*!o("sjnA"),"Object",{defineProperty:o("lIiZ").f})},TgUw:function(e,t,o){"use strict";t.a=function(e,t,o,i,n){!function(e,t,o,i,n,l){n||(n=a);l||(l=r);var s=e.XLSX.utils.json_to_sheet([],{header:t}),c={SheetNames:[n],Sheets:t,Props:{}};e.XLSX.utils.sheet_add_json(s,o,i),c.Sheets[n]=s,e.fileSaver.saveAs(new Blob([function(e){if("undefined"!=typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),r=0;r!=e.length;++r)o[r]=255&e.charCodeAt(r);return t}for(var a=new Array(e.length),i=0;i!=e.length;++i)a[i]=255&e.charCodeAt(i);return a}(e.XLSX.write(c,l))],{type:"application/octet-stream"}),n+"."+("biff2"==l.bookType?"xls":l.bookType))}(e,t,i,{header:o,skipHeader:!0,origin:"A2"},n)};var r={bookType:"xlsx",bookSST:!1,type:"binary"},a="ExportTable"},WIY8:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUExQzlFQkE1N0RFMTFFN0E3RjBCQ0MyRTEwN0M3OEMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUExQzlFQkI1N0RFMTFFN0E3RjBCQ0MyRTEwN0M3OEMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1QTFDOUVCODU3REUxMUU3QTdGMEJDQzJFMTA3Qzc4QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QTFDOUVCOTU3REUxMUU3QTdGMEJDQzJFMTA3Qzc4QyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhhsNOAAAAIUSURBVHja7JlNSwJRFIbPXLUGh6I0KBvCRNOm7y/7tAjatG4RBdW6bVT0J1q0bN2mRbRvVRBEizAKI8s2Cv2CQqhF2n0jJEpkckYd4Z7lzDnveWbm3nPOZeyq2jagKMqBpnX2MmYjq1gm80Hx+EMsnU6vUUdHKJZMJrNWNHCBjwWDwR6v10tWNHCBj0mSRFY28DGqAhOQAlJACsgKmj3XK7NZmr+6ptuX14pD9dfX0Ul4iNh3o8m9yQ8O+fz2bok3Bw7w/PncDsbofDxMrXJtRQGRHxzgybsmm2ocdDk5RlqdUhHALp4X+cFRcOPI/AnOxsI0424sKyDynfK8MmP6djeW69FgPy2rLVTqGQn6yIN8UjElaE/rpE1/e8lAoQt95DFUJ7d9XKRbMx0UetCFvu46WciWPM3UxnfdQvTGNMjj4QGaamwwt+NA8GJylGqYsSaFeOjoBfx3Www4nXQTmSDXrxKh1xCHeOiUtHe7eaLo1DgFlP8lgj/i3EU8YFHfzmmz8Vo6QtMufbUUfvBHXFmnIKytw8E+WmxtKeiH+/AzspYN7QIHn1L2tBBt+PKf23Ed9x0Gj812o6XExgF2/D5SZZm24o+567scbkX1mFJf7SZofIGsciBMMOuxe9rv7aI5t8v8odcMA9jTbESccQSkgBSQArLckNkfh3ArGvhYIpG4S6VSlgQEF/ikaviP8ynAANepEZhL4SZtAAAAAElFTkSuQmCC"},a3Yh:function(e,t,o){"use strict";t.__esModule=!0;var r,a=o("liLe"),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e,t,o){return t in e?(0,i.default)(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},fjIZ:function(e,t,o){"use strict";function r(e){return("00"+e).substr(e.length)}t.a=function(e,t){e instanceof Date||(e=new Date(1e3*e));/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var o={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var a in o){var i=o[a]+"";new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?i:r(i)))}return t}},ioPB:function(e,t){},liLe:function(e,t,o){e.exports={default:o("JhHb"),__esModule:!0}},yB3Q:function(e,t,o){"use strict";(function(e){o.d(t,"a",function(){return r});var r=function(){var t,o,r,a,i,n,l,s,c,u,p,d,f,m,h,y,g="http://139.196.5.153:8080",v="http://139.196.5.153:8080",_="http://139.196.5.153:8181/geoserver/wms?",b=document.createElement("div");b.setAttribute("id","up");var I=document.createElement("img");I.setAttribute("src","../../../static/img/up.png"),b.appendChild(I);var S=document.createElement("div");S.setAttribute("id","down");var A,x=document.createElement("img");x.setAttribute("src","../../../static/img/down.png"),S.appendChild(x);var w=function(e,t,o){this.build_id=e,this.floor_id=t,this.cameraUrl="http:192.168.0.109",this.param=o.param,this.type="camera",this.coordinates=o.coordinates,this.setCameraStyle=function(){var e=new ol.style.Style({image:new ol.style.Icon({src:"../../../static/img/22/main/noconfig/21@3x.png",scale:.55})});this.setStyle(e)}},C=function(e,t,o){this.build_id=e,this.floor_id=t,this.type="car",this.carArea=o.carArea,this.carFloor=o.carFloor,this.carFloorID=o.carFloorID,this.carNum=o.carNum,this.carUID=o.carUID,this.carposPoint=o.carposPoint,this.coordinates=o.coordinates,this.car_state="",this.car_number="",this.car_enterTime="",this.car_picUrl="",this.car_videoUrl="",this.setCarColor=function(e){var t=new ol.style.Style({fill:new ol.style.Fill({color:e}),stroke:new ol.style.Stroke({width:1,color:"white"}),text:new ol.style.Text({font:"10px sans-serif",text:o.carNum,textAlign:"center",fill:new ol.style.Fill({color:"black"})})});this.setStyle(t)}},F=function(){this.setPortColor=function(e,t,o,r){this.type="carPoint",this.carArea=e.carArea,this.carFloor=e.carFloor,this.carFloorID=e.carFloorID,this.carNum=e.carNum,this.carUID=e.carUID,this.carposPoint=e.carposPoint,this.coordinates=e.coordinates;var a=new ol.style.Style({text:new ol.style.Text({font:"10px sans-serif",text:t,textAlign:o,fill:new ol.style.Fill({color:r})})});this.setStyle(a)}},D=function(e){this.type="carEvent",this.carArea=e.carArea,this.carFloor=e.carFloor,this.carFloorID=e.carFloorID,this.carNum=e.carNum,this.carUID=e.carUID,this.carposPoint=e.carposPoint,this.coordinates=e.coordinates,this.car_state="",this.car_number="",this.car_enterTime="",this.car_picUrl="",this.car_videoUrl="",this.setPortColor=function(e,t,o){var r=new ol.style.Style({text:new ol.style.Text({font:"10px sans-serif",text:e,textAlign:t,fill:new ol.style.Fill({color:o})})});this.setStyle(r)}},T=function(e){this.inpointFloorID=e.inpointFloorID,this.inpointID=e.inpointID,this.inpointType=e.inpointType,this.inpointName=e.inpointName,this.inpointfloor=e.inpointfloor,this.coordinates=e.coordinates,this.setInterImg=function(e){var t=new ol.style.Style({image:new ol.style.Icon({src:"../../../static/img/info/"+e+"@3x.png",scale:.25})});this.setStyle(t)}};!function(t,o,r){e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",data:{cityID:"",buildingID:r},url:t+"/mapserve/floor",success:function(e){var t=e;1==t.result?(l=t.olmapWidth,s=t.olmapHeight):console.log("返回数据失败!")},error:function(e,t,o){"timeout"==e.statusText?console.log("请求超时!"):console.log("服务器出错!")}})}(v,0,"B0009");var U=function(t,o,r){p=new ol.source.Vector,e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",data:{build_id:o,floor:r},url:t+"/SttingParam/LightParam?",success:function(e){var t=e;1==t.result?function(e,t,o){for(var r=0;r<o.param_list.length;r++){o.param_list[r].flag;var a=o.param_list[r].param.dev_type;if(7==a||2==a){w.prototype=new ol.Feature({});var i=new w(e,t,o.param_list[r]);i.setGeometry(new ol.geom.Point(i.coordinates)),i.setCameraStyle(),p.addFeature(i),$.setSource(p)}}}(o,r,t):console.log("返回数据失败!")},error:function(e,t,o){"timeout"==e.statusText?console.log("请求超时!"):console.log("服务器出错!")}})},N=0,M=function(n){var l=e("#floorUl").height()-35,s=e("#floor").offset().top+2-35,u=e("#floorUl").offset().top,p=e("#floor").offset().top,d=u-p,f=e("#floorUl li").offset().top-p-2;-d>=l?e("#floorUl").css("top",-l+"px"):(N++,e("#floorUl").css("top","-"+35*N+"px"));for(var m=0;m<t.length;m++){(f=e("#"+t[m].floorId).offset().top-s)>0&&f<=35?(e("#"+t[m].floorId).css({color:"red","font-size":"24px"}),B(_,t[m].floorUrl),a=t[m].floorId,c=t[m].floorNum,o=t[m].floorName,ie.prototype.floor=o,ie.prototype.floorId=a,Q(g,r,t[m].floorId,i),U(v,r,t[m].floorId)):e("#"+t[m].floorId).css({color:"black","font-size":"18px"})}return n(o,a)},R=function(n){e("#floorUl").height();var l=e("#floorUl").offset().top,s=e("#floor").offset().top+2-35,u=e("#floor").offset().top,p=l-u,d=e("#floorUl li").offset().top-u-2;-p<=0?(e("#floorUl").css("top","0px"),N=0):(N--,e("#floorUl").css("top","-"+35*N+"px"));for(var f=0;f<t.length;f++){(d=e("#"+t[f].floorId).offset().top-s)>0&&d<=35?(e("#"+t[f].floorId).css({color:"red","font-size":"24px"}),B(_,t[f].floorUrl),a=t[f].floorId,c=t[f].floorNum,o=t[f].floorName,ie.prototype.floor=o,ie.prototype.floorId=a,Q(g,r,t[f].floorId,i),U(v,r,t[f].floorId)):e("#"+t[f].floorId).css({color:"black","font-size":"18px"})}return n(o,a)},E=function(){Q(g,r,a,i)};S.addEventListener("click",function(){M(k)}),b.addEventListener("click",function(){R(k)});var G,V,k=function(){console.log(777)},j=(new ol.style.Style({fill:new ol.style.Fill({color:"#83CC1B"}),stroke:new ol.style.Stroke({width:1,color:"white"})}),new ol.style.Style({text:new ol.style.Text({font:"14px sans-serif",text:1,textAlign:"center",fill:new ol.style.Fill({color:"black"})})}),new ol.style.Style({image:new ol.style.Icon({src:"../../../static/img/screen.png",scale:.55})})),L=new ol.style.Style({image:new ol.style.Icon({src:"../../../static/img/floor/u.png",scale:.55})}),Z=function(e,t,o,r){for(let e=0;e<r.length;e++)for(let o=0;o<t.carpos_Info.length;o++)t.carpos_Info[o].carpos_gid==r[e].carUID&&(r[e].car_state=t.carpos_Info[o].car_state,r[e].car_number=t.carpos_Info[o].car_number,r[e].car_enterTime=t.carpos_Info[o].car_enterTime,r[e].car_picUrl=t.carpos_Info[o].car_picUrl,r[e].car_videoUrl=t.carpos_Info[o].car_videoUrl);for(let e=0;e<o.length;e++)for(let r=0;r<t.carpos_Info.length;r++)if(t.carpos_Info[r].carpos_gid==o[e].carUID){o[e].car_state=t.carpos_Info[r].car_state,o[e].car_number=t.carpos_Info[r].car_number,o[e].car_enterTime=t.carpos_Info[r].car_enterTime,o[e].car_picUrl=t.carpos_Info[r].car_picUrl,o[e].car_videoUrl=t.carpos_Info[r].car_videoUrl,"0"==o[e].car_state?o[e].setCarColor("#85e249",o[e].carNum,"center","black"):"1"==o[e].car_state?o[e].setCarColor("#fd435a",o[e].carNum,"center","black"):"2"==o[e].car_state?o[e].setCarColor("#ffbb44",o[e].carNum,"center","black"):"3"==o[e].car_state?o[e].setCarColor("#000000",o[e].carNum,"center","black"):"4"==o[e].car_state?o[e].setCarColor("#4882ff",o[e].carNum,"center","black"):"5"==o[e].car_state?o[e].setCarColor("#d1980d",o[e].carNum,"center","black"):o[e].setCarColor("#cccccc",o[e].carNum,"center","black");break}},P=function(e,t,o){for(var r=0;r<t.length;r++)t[r].carpos_gid==o.carUID&&(o.carpos_ratio=100*t[r].carpos_ratio,o.carpos_ratio>=0&&o.carpos_ratio<=20?o.setCarColor("#9ade31",o.carNum,"center","black"):o.carpos_ratio>=21&&o.carpos_ratio<=40?o.setCarColor("#fbdc44",o.carNum,"center","black"):o.carpos_ratio>=41&&o.carpos_ratio<=60?o.setCarColor("#f8aa2e",o.carNum,"center","black"):o.carpos_ratio>=61&&o.carpos_ratio<=80?o.setCarColor("#ff8350",o.carNum,"center","black"):o.setCarColor("#fd435a",o.carNum,"center","black"))},Y=function(t,o,r,a){var i;return e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",url:t+"/GOSSystem/getCarposSumInfo",data:{user_id:o,floor_id:a,build_id:r},timesout:3500,success:function(e){0==e.result?console.log("返回数据失败!"):i=e},error:function(e,t,o){"timeout"==e.statusText?console.log("请求超时!"):console.log("服务器出错!")}}),i},O=function(t,o,r,a){var i;return e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",url:t+"/GOSSystem/getCarposMapInfo",data:{user_id:o,floor_id:a,build_id:r},success:function(e){0==e.result?console.log("返回数据失败!"):i=e},error:function(e,t,o){"timeout"==e.statusText?console.log("请求超时!"):console.log("服务器出错!")}}),i},Q=function(t,o,r,i){var l,s;e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",url:t+"/mapserve/carposinpoint?",data:{floorID:r,buildingID:o},success:function(t){if(console.log(t),0==t.result)alert("返回数据失败!");else{var c=t.response_carpos,p=t.response_inpoint;"carState"==i?(f=O(d,"beefind001",o,a),m=Y(d,"beefind001",o,a),ie.prototype.carpos_sum=m.carpos_sum,y=[],h=setInterval(function(){f=O(d,"beefind001",o,a),m=Y(d,"beefind001",o,a),console.log(f),console.log(m),ie.prototype.carpos_sum=m.carpos_sum,y=[],Z(0,f,l,s)},12e4)):"useState"==i?(clearInterval(h),1==(y=function(t,o,r,a,i){var n,l=i;return e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",url:t+"/GOSSystem/getEachCarposRatio",data:{user_id:o,floor_id:a,build_id:r,start_time:l.start_time,end_time:l.end_time},success:function(e){n=e},error:function(e,t,o){"timeout"==e.statusText?alert("请求超时!"):alert("服务器出错!")}}),n}(d,"beefind001",o,r,n)).result&&(y=y.eachCarpos_list),f=[],m=[]):(clearInterval(h),f=[],m=[]),""!=c&&void 0!=c&&null!=c&&(G=new ol.source.Vector,new ol.source.Vector,V=new ol.source.Vector,function(e,t,o,r,a,i){for(var n=0;n<o.length;n++){C.prototype=new ol.Feature({}),F.prototype=new ol.Feature({}),D.prototype=new ol.Feature({});var l,s=new C(e,t,o[n]);s.setGeometry(new ol.geom.Polygon([s.coordinates])),s.carNum.replace(/[^0-9]/gi,"")%2==0&&((l=new D(o[n])).setGeometry(new ol.geom.Point(s.carposPoint)),l.setPortColor(s.carNum,"center","black"),V.addFeature(l)),"carState"==i?s.setCarColor("#cccccc",s.carNum,"center","black"):"useState"==i?(s.setCarColor("#9ade31",s.carNum,"center","black"),P(0,a,s)):"screenControl"==i?s.setCarColor("#969696",s.carNum,"center","black"):s.setCarColor("#9ade31",s.carNum,"center","black"),G.addFeature(s)}J.setSource(G),K.setSource(V)}(o,r,c,0,y,i),"carState"==i&&(l=J.getSource().getFeatures(),s=K.getSource().getFeatures(),Z(0,f,l,s))),""!=p&&void 0!=p&&null!=p&&(u=new ol.source.Vector,function(e){null!=q.getSource()&&""!=q.getSource()&&void 0!=q.getSource()&&q.getSource().clear();for(var t=0;t<e.length;t++){T.prototype=new ol.Feature({});var o=new T(e[t]);o.setGeometry(new ol.geom.Point(o.coordinates)),o.setInterImg(o.inpointType),u.addFeature(o)}q.setSource(u)}(p))}},error:function(e,t,o){"timeout"==e.statusText?alert("请求超时!"):alert("服务器出错!")}})},z=function(e,t,o,r,a){var i=document.createElement("li");i.setAttribute("id",t),i.setAttribute("name",a),console.log(o),i.innerText=o,i.innerHTML=o,A.appendChild(i),i.style.width="35px",i.style.height="35px",i.style.overflow="hidden",i.offsetTop>=0&&i.offsetTop<35?(i.style.color="red",i.style.fontSize="24px"):(i.style.color="black",i.style.fontSize="18px")},B=function(e,t){var o=t.substr(0,14)+"_MAP",r=new ol.source.TileWMS({url:e,params:{layers:o},serverType:"geoserver"});H.setSource(r)},W=function(i,n,u,p,d,f){t=[],e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",url:i+"/mapserve/floor?",data:{cityID:n,buildingID:u},timeout:3500,success:function(n){if(0==n.result)alert("请求数据失败!");else{var m,h;l=n.olmapWidth,m=91548==(s=n.olmapHeight)?91548/s*9.55:91548/s*9.55*.23,h=[parseFloat(l/2),-parseFloat(s/2)],ae.getView().setCenter(h),ae.getView().setZoom(m),""==p||null==p||void 0==p?(c=n.response[0].floorNum,a=n.response[0].floorID,p=a,console.log("OlBuildId="+r+"OlFloorId="+a+"OlFloorNum="+c),Q(i,u,a,f),U(i,u,a)):(console.log("初始OlBuildId="+r+"OlFloorId="+a+"OlFloorNum="+c),console.log("floorId==>"+p),Q(i,u,p,f),U(i,u,p)),console.log(p);for(var y=0;y<n.response.length;y++){if(t[y]=new Object,t[y].floorId=n.response[y].floorID,t[y].floorName=n.response[y].floorName,t[y].floorNum=n.response[y].floorNum,t[y].floorUrl=n.response[y].floorUrl,t[y].index=y,n.response[y].floorID==p){var g=n.response[y].floorUrl;B(d,g),o=n.response[y].floorName,ie.prototype.floor=o,ie.prototype.floorId=p,t[y].index,e("#floorUl").css("top","-35"*y+"px"),N=y}console.log("crearteFloor"),z(0,n.response[y].floorID,n.response[y].floorName,n.response[y].floorUrl,y)}}},error:function(e,t,o){"timeout"==e.statusText?alert("请求超时!"):alert("服务器出错!")}})},H=new ol.layer.Tile({}),J=new ol.layer.Vector({}),X=new ol.layer.Vector({}),K=new ol.layer.Vector({}),q=new ol.layer.Vector({}),$=new ol.layer.Vector({}),ee=new ol.layer.Vector({source:new ol.source.Vector}),te=new ol.layer.Vector({source:new ol.source.Vector}),oe=new ol.layer.Vector({}),re=ol.interaction.defaults({altShiftDragRotate:!1,pinchRotate:!1}),ae=new ol.Map({layers:[H,J,X,K,q,$,ee,te,oe],target:"",interactions:re,controls:ol.control.defaults({attributionOptions:{collapsible:!1}}),view:new ol.View({center:[80,-80],projection:"EPSG:3857",zoom:10,maxZoom:14,minZoom:8.5,extent:[0,-s,l,0]}),logo:!1,controls:ol.control.defaults({attribution:!1,zoom:!1})}),ie=function(t){this.extend=function(e,t){for(var o in t)e[o]=t[o];return e},this.options=this.extend({target:"map",city_id:"F0021",mapType:"",floorUl:"",urlLocal:"",timeDate:"",build_id:"B0003",floor_id:"",floor_num:"",url:"http://139.196.5.153:8080",floorBarVisible:!1,carLayerVisible:!0,carPortLayerVisible:!0,interLayerVisible:!0,deviceLayerVisible:!1,mapUrl:"http://139.196.5.153:8181/geoserver/wms?"},t),this.city_id=this.options.city_id,this.build_id=this.options.build_id,this.floor_id=this.options.floor_id,this.floorName="M",this.map=ae,this.setTime=function(e){n=e},this.target=function(e){this.map.setTarget(e)},this.init=function(){this.options.target;A=this.options.floorUl,console.log(A),n=this.options.timeDate,r=this.options.build_id,a=this.options.floor_id,ae.setTarget(this.options.target),i=this.options.mapType,console.log("this.options.urlLocal==>"+this.options.urlLocal),d=void 0==this.options.urlLocal?"http://192.168.0.100:8421":this.options.urlLocal,console.log(this.options.floor_id),console.log("testUrl==>"+g),console.log("mapUrl==>"+this.options.mapUrl),console.log("localUrl==>"+d),W(g,"",this.options.build_id,this.options.floor_id,this.options.mapUrl,this.options.mapType),this.options.floorBarVisible?(e("#up").show(),e("#down").show(),e("#floor").show()):(e("#up").hide(),e("#down").hide(),e("#floor").hide()),this.options.carLayerVisible?J.setVisible(!0):J.setVisible(!1),this.options.carPortLayerVisible?X.setVisible(!0):X.setVisible(!1),this.options.interLayerVisible?q.setVisible(!0):q.setVisible(!1),this.options.deviceLayerVisible?$.setVisible(!0):$.setVisible(!1)},this.nextFloor=function(){M()},this.beforeFloor=function(){R()},this.refreshUseCar=function(){E()},this.init()};ie.prototype=ae,ie.constructor=ie;return ae.on("moveend",function(){var e=ae.getView().getZoom();e>9.7?e>11?(X.setVisible(!0),K.setVisible(!1)):(K.setVisible(!0),X.setVisible(!1)):(X.setVisible(!1),K.setVisible(!1))}),{BeefindMap:ie,floorSuccess:k,getVideoUrl:function(t,o,r,a){var i;return e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",url:t+"/listmac",data:{device_id:o,device_area:r,device_floorID:a},success:function(e){i=e},error:function(e,t,o){"timeout"==e.statusText?console.log("请求超时!"):console.log("服务器出错!")}}),i},getCameraDate:function(t,o,r,a){var i;return e.ajax({cache:!1,type:"POST",async:!1,dataType:"json",timeout:2e3,url:t+"/getVideoDate",data:{build_id:o,area_id:r,dev_id:a},success:function(e){i=e},error:function(e,t,o){var r={result:0};e.statusText,i=r}}),i},upFloor:R,downFloor:M,refreshUseCar:E,clearStateInter:function(){clearInterval(h)},addScreen:function(e){if(ee.getSource().clear(),null!=e&&void 0!=e.screen_x&&void 0!=e.screen_y){let t=new ol.Feature({});t.floor_id=e.floor_id,t.setGeometry(new ol.geom.Point([e.screen_x,e.screen_y])),t.setStyle(j),ee.getSource().addFeature(t),ee.setVisible(!0)}},addVipIcon:function(e){if(te.getSource().clear(),null!=e&&void 0!=e.carposPoint){let t=new ol.Feature({});t.floor_id=e.floor_id,t.setGeometry(new ol.geom.Point([e.carposPoint[0],e.carposPoint[1]])),t.setStyle(L),te.getSource().addFeature(t),te.setVisible(!0)}},screenCarColor:function(e,t){let o,r=J.getSource().getFeatures(),a=K.getSource().getFeatures();function i(e){return e.carUID==o}function n(e){return e.carUID==o}a.forEach(function(e,t,o){e.choseCar=!1});let l=e.message,s=e.index,c=e.carColor;r.forEach(function(e){e.setCarColor("#969696"),e.choseCar=!1,e.index=s,e.message=l,e.carColor=c}),e.carpos_list.forEach(function(e,u,p){o=e.carpos_gid;var d=r.filter(i);d[0].index=s,d[0].message=l,d[0].carColor=c,d[0].choseCar=!0,d[0].setCarColor(t);var f=a.filter(n);f.length>=1&&(f[0].index=s,f[0].message=l,f[0].carColor=c,f[0].choseCar=!0)},this.val)},resetCarColor:function(e){J.getSource().getFeatures().forEach(function(t,o,r){t.setCarColor(e)})},resetFeatureCarColor:function(e,t){let o=t;J.getSource().getFeatures().forEach(function(t,r,a){o.carUID==t.carUID&&t.setCarColor(e)})},setVipCarColor:function(e,t){let o=J.getSource().getFeatures();o.forEach(function(e,t,o){e.VipCar=!1,e.car_numbers=[]}),e.forEach(function(e,r,a){o.forEach(function(o,r,a){o.carUID==e.carpos_gid&&(o.VipCar=!0,o.car_numbers=e.car_numbers,o.setCarColor(t))})})},findCarFeature:function(e){var t=J.getSource().getFeatures().filter(function(t){return t.carUID==e.carUID});return t=t[0]}}}()}).call(t,o("L7Pj"))}});
//# sourceMappingURL=0.9f78be200e271c3e3344.js.map